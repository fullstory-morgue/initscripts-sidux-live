# shapi
# A shared shell api

shapi.dialog.setup (){
 if [ -z "$SHAPI_ENV" ] ; then
  shapi.detect.env
 fi
 case $SHAPI_ENV in
 gnome)
  SHAPI_DIALOG="zenity"
  ;;
 kde)
  SHAPI_DIALOG="kdialog"
  ;;
 X)
  SHAPI_DIALOG="Xdialog"
  ;;
 tty)
  SHAPI_DIALOG="dialog"
  ;;
 esac
 [ -z "$(which SHAPI_DIALOG)" ] && echo "error: I am running in $SHAPI_ENV but I cannot find $SHAPI_DIALOG" && exit
}

shapi.detect.env (){
 if [ -z "$SHAPI_ENV" ]; then
  SHAPI_ENV=X
  # kdialog (in case there is no console available and we are running KDE)
  pidof kdesktop >/dev/null && SHAPI_ENV="kde"
  # GNOME
  pidof gnome-panel >/dev/null && SHAPI_ENV="gnome"
  # dialog (in case there is a console available)
  ( echo $(tty) | grep /dev/tty[:digit:] >/dev/null ) && SHAPI_ENV="tty"
 fi
}

shapi.dialog.geometry(){
# shapi.dialog.geometry height width
 case $SHAPI_DIALOG in
 gnome)
  [ -n "$3" ] && SHAPI_DIALOG_GEOMETRY="--height=$1"
  [ -n "$4" ] && SHAPI_DIALOG_GEOMETRY="$SHAPI_DIALOG_GEOMETRY --width=$2"
 ;;
 kdialog)
 ;;
 *)
  SHAPI_DIALOG_GEOMETRY "$1 $2"
 ;;
 esac
}

# Simple Prompts
#shapi.dialog.yesno title text height width help default
# TARGET

#shapi.dialog.yesno.warning title text height width help default

shapi.dialog.textinput(){
# shapi.dialog.textinput title text height width help init
 shapi.dialog.setup
 shapi.dialog.geometry $3 $4
 case $SHAPI_DIALOG in
 zenity)
  SHAPI_DIALOG_ARG="--entry --title=\"$1\" --text \"$2\" --entry-text=\"$6\" $SHAPI_DIALOG_GEOMETRY"
  ;;
 kdialog)
  $SHAPI_DIALOG_ARG="--inputbox \"$2\" \"$6\" --caption \"Message\" --title \"$1\""
  ;;
 *)
  $SHAPI_DIALOG_ARG="--title \"$1\" --inputbox \"$2\"\" $SHAPI_DIALOG_GEOMETRY" "$6"
  ;;
 esac
 $SHAPI_DIALOG $SHAPI_DIALOG_ARG
}

#shapi.dialog.password title text height width default
#shapi.dialog.time title text height width [ hour minute second ]
#shapi.dialog.calendar title text height width [ day month year ]

# File/Directories
#shapi.dialog.fselect title height width help default
#shapi.dialog.dselect title height width help default

# Menus
#shapi.dialog.menu title text height width menu-height help default [ tag item ] ...
#shapi.dialog.menu.radio title text height width menu-height help default [ tag item status ] ...
#shapi.dialog.menu.check title text height width menu-height help default [ tag item status ] ...

# Feedback
shapi.dialog.error(){
# shapi.dialog.error title text height width help
 shapi.dialog.setup
 shapi.dialog.geometry $3 $4
 case $SHAPI_DIALOG in
 zenity)
  SHAPI_DIALOG_ARG="--error --title=\"$1\" --text \"$2\" $SHAPI_DIALOG_GEOMETRY"
  ;;
 kdialog)
  $SHAPI_DIALOG_ARG="--error \"$2\" --caption \"Message\" --title \"$1\""
  ;;
 *)
  $SHAPI_DIALOG_ARG="--title \"$1\" --msgbox \"ERROR: $2\"\" $SHAPI_DIALOG_GEOMETRY"
  ;;
 esac
 $SHAPI_DIALOG $SHAPI_DIALOG_ARG
}

shapi.dialog.message(){
# shapi.dialog.message title text height width help
 shapi.dialog.setup
 shapi.dialog.geometry $3 $4
 case $SHAPI_DIALOG in
 zenity)
  SHAPI_DIALOG_ARG="--info --title=\"$1\" --text \"$2\" $SHAPI_DIALOG_GEOMETRY"
  ;;
 kdialog)
  $SHAPI_DIALOG_ARG="--msgbox \"$2\" --caption \"Message\" --title \"$1\""
  ;;
 *)
  $SHAPI_DIALOG_ARG="--title \"$1\" --msgbox \"$2\"\" $SHAPI_DIALOG_GEOMETRY"
  ;;
 esac
 $SHAPI_DIALOG $SHAPI_DIALOG_ARG
}

#shapi.dialog.message.bg title text height width help
#shapi.dialog.gauge title text height width help default
#shapi.dialog.watchfile title height width file
#shapi.dialog.watchfile.bg title height width file
#shapi.dialog.showfile title height width file

# Other dialogs
#shapi.dialog.form title text height width formheight [ label y x item y x flen ilen ] ...
#shapi.dialog.pause title text height width seconds

#shapi.su command
# TARGET

#shapi.var.load file
#shapi.var.write file [ varname ] ...
#shapi.var.update file [ varname value ] ...

#shapi.download file ... [ target ]
